name: Debug Repository Structure

on:
  push:
    branches: [main]

jobs:
  debug:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v4
    
    - name: Show full repository structure
      run: |
        echo "=== STEP 1: Current directory ==="
        pwd
        echo ""
        
        echo "=== STEP 2: List all files in root ==="
        ls -la
        echo ""
        
        echo "=== STEP 3: List all directories in root ==="
        ls -la */
        echo ""
        
        echo "=== STEP 4: Search for package.json everywhere ==="
        find . -name "package.json" -type f | while read file; do
          echo "Found: $file"
          echo "Directory: $(dirname $file)"
          echo "Contents of that directory:"
          ls -la $(dirname $file)
          echo "---"
        done
        echo ""
        
        echo "=== STEP 5: Check if this is a Next.js app ==="
        find . -name "next.config.js" -o -name "next.config.ts" 2>/dev/null || echo "No Next.js config found"
        echo ""
        
        echo "=== STEP 6: Check if this is a React app (create-react-app) ==="
        find . -name "craco.config.js" -o -name "react-app-env.d.ts" 2>/dev/null || echo "No CRA specific files found"
        echo ""
        
        echo "=== STEP 7: Look for common build output directories ==="
        for dir in "build" "dist" "out" ".next" "public"; do
          if [ -d "$dir" ]; then
            echo "Found $dir directory in root"
          else
            echo "No $dir directory in root"
          fi
        done
        echo ""
        
        echo "=== STEP 8: Check for any JavaScript/TypeScript files ==="
        echo "Top 20 JS/TS files found:"
        find . -type f \( -name "*.js" -o -name "*.jsx" -o -name "*.ts" -o -name "*.tsx" \) -not -path "*/node_modules/*" | head -20
        echo ""
        
        echo "=== STEP 9: Check package.json content if found ==="
        find . -name "package.json" -type f | while read file; do
          echo "Content of $file:"
          cat "$file" | head -30
          echo "---"
        done
